package com.casr.createContact;

import org.openqa.selenium.By;
import org.testng.annotations.Test;
import org.testng.asserts.SoftAssert;

import aDomainname.appname.modulename.BaseClass;
import co.cast.generic.BaseClass.createOrganization;
import co.cast.generic.BaseClass.homeContact;
import co.cast.generic.BaseClass.orgInfoVerify;
import co.cast.generic.FileUtility.ExcelUtility;

public class crmContactsTest extends BaseClass {

	@Test(priority=1)
	public void createContact() throws Exception {
		//click on contact linkText
		homeContact home=new homeContact(driver);
		home.contact();
		/**
		 * enter lastname and click on save
		 */
		String lastname=elib.getDataFromExcel("contact", 1, 2) +jvlib.getRandomNumber();
		createNewContact cnc=new createNewContact(driver);
		cnc.getlastname().sendKeys(lastname);
		cnc.getsavebtn().click();
		
		/**
		 * verifycation to check if its equals
		 */
	String headercontact= driver.findElement(By.className("dvHeaderText")).getText();
   
   if(headercontact.contains(lastname)) {
	   System.out.println(lastname+"verified==>pass");
   }else {
	   System.out.println(lastname+"verified==>fail");
   }
	}
	@Test (priority=2)
	public void contacWithDate() throws Exception {
		homeContact home=new homeContact(driver);
		home.contact();
		/**
		 * enter lastname and click on save
		 */
		String lastname=elib.getDataFromExcel("contact", 1, 2) +jvlib.getRandomNumber();
		createNewContact cnc=new createNewContact(driver);
		cnc.getlastname().sendKeys(lastname);
		wlib.ScrollByAmount(driver);
		cnc.getStrdate().clear();
  String sdate =    jvlib.getRequiredDateYYYYMMDD(30);
  cnc.getStrdate().sendKeys(sdate);
  
	}
	@Test(priority=3)
	public void contactWithOrg()throws Exception {
		homeContact home=new homeContact(driver);
		home.contact();
		/**
		 * enter lastname and click on save
		 */
		String lastname=elib.getDataFromExcel("contact", 1, 2) +jvlib.getRandomNumber();
		createNewContact cnc=new createNewContact(driver);
		cnc.getlastname().sendKeys(lastname);
		//save the details
		cnc.getsavebtn().click();
	String headercontact=	driver.findElement(By.className("dvHeaderText")).getText();
		if(headercontact.contains(lastname)) {
			System.out.println(lastname+" is verified ==>pass");
		}else {
			System.out.println(lastname+"is verified ==> fail");
		}
		createOrganization co=new createOrganization(driver);
		co.gettext().click();
		
		co.getcreatebtn().click();
String orgname=elib.getDataFromExcel("org", 1, 0) + jvlib.getRandomNumber();
		
		creatNewOrganization on=new creatNewOrganization(driver);
		on.getorgname().sendKeys(orgname);
		on.getsave().click();
		//verify the organization contans actual name orgname
		orgInfoVerify oi=new orgInfoVerify(driver);
	String ver=	oi.getverify().getText();
		
	SoftAssert soft=new SoftAssert();
	soft.assertEquals(orgname, ver);
	soft.assertAll();	
	}
	@Test
	public void deleteContact() throws Exception{
		//click on contact link
		homeContact home=new homeContact(driver);
		home.contact();
		
			ExcelUtility ex=new ExcelUtility();
String searchtxtex=ex.getDataFromExcel("cart", 0, 0);
		createContact cc=new createContact(driver);
		cc.gettxtfield().sendKeys(searchtxtex);
		
		cc.getSelectField();
		
		cc.getSearchBtn().click();
	}
	
}
